,11,d);c.Br()||O(c,1,1);sq(a.H,1,c)}this.L&&(a.W=this.L);this.C&&qUf(a,this.C);return a};function epi(){var a=void 0===a?"":a;a||(a=(a=(a=rt(Hs().location.href))&&/\/u\/(\d+)\/?/.exec(a))?a[1]:"0");this.F=a;this.C=(new dpi(this.F)).build()}epi.prototype.log=function(a){var b=this.C;a instanceof rY?b.log(a):(a=H0e(new rY,a.ab()),b.log(a))};var fpi;function C6(){fpi||(fpi=new epi);return fpi};function gpi(a){M(this,a,0,-1,null,hpi)}E(gpi,L);var hpi=[[1]];function ipi(){var a=new gpi,b=new nni;return cT(a,1,hpi[0],b)};function jpi(a){M(this,a,0,-1,null,null)}E(jpi,L);function kpi(a){return O(a,1,"CSE Demo")}function lpi(a,b){return O(a,2,b)};function mpi(a){M(this,a,0,-1,null,null)}E(mpi,L);function npi(a,b){return sq(a,1,b)}function opi(a,b){return O(a,2,b)}function ppi(a,b){return sq(a,3,b)}function qpi(a,b){return sq(a,4,b)}function rpi(a,b){return O(a,5,b)};function spi(a){M(this,a,0,-1,null,null)}E(spi,L);function tpi(a,b){return sq(a,1,b)}function upi(a,b){return sq(a,2,b)}function vpi(a,b){return O(a,3,b)};function wpi(a){a=Error.call(this,a);this.message=a.message;cPf in a&&(this.stack=a.stack)}B(wpi,Error);wpi.prototype.name="KaclsError";function xpi(a){M(this,a,0,-1,null,null)}E(xpi,L);function ypi(a){M(this,a,0,-1,null,null)}E(ypi,L);function zpi(a){M(this,a,0,-1,null,null)}E(zpi,L);function Api(a){M(this,a,0,-1,null,null)}E(Api,L);var Bpi={"content-type":myf};
function Cpi(a){var b=Date.now(),c={key:$ki(N(a,1)),authorization:N(a,3),authentication:N(a,2),reason:N(a,4)};return new Promise(function(d,e){var f=Dpi(N(a,3),"/wrap"),g=Ooi(Noi(1),f);zt(f,function(k){k=k.target;var l=Date.now()-b;l=O(g,3,l);var m=k.Xc();O(l,4,m);if(k.vk()){l="";try{l=k.Yu().wrapped_key}catch(n){O(g,5,2);C6().log(Qoi(new B6,g.clone()));e(new wpi(Mji+n.message));return}l?(O(g,5,1),C6().log(Qoi(new B6,g.clone())),k=new Api,k=O(k,1,l),d(k)):(O(g,5,3),C6().log(Qoi(new B6,g.clone())),
e(new wpi("wrapped_key is missing in KACLS response")))}else e(new wpi("Wrap request to KACLS failed: "+k.rz())),C6().log(Qoi(new B6,g.clone()))},Tb,JSON.stringify(c),Bpi)})}
function Epi(a){var b=Date.now(),c={wrapped_key:N(a,1),authorization:N(a,3),authentication:N(a,2),reason:N(a,4)};return new Promise(function(d,e){var f=Dpi(N(a,3),"/unwrap"),g=Ooi(Noi(2),f);zt(f,function(k){k=k.target;var l=Date.now()-b;l=O(g,3,l);var m=k.Xc();O(l,4,m);if(k.vk()){l="";try{l=k.Yu().key}catch(n){e(new wpi(Mji+n.message));O(g,5,2);C6().log(Qoi(new B6,g.clone()));return}l?(O(g,5,1),C6().log(Qoi(new B6,g.clone())),k=new ypi,l=Uint8Array.from(gFa(l)),k=O(k,1,l),d(k)):(e(new wpi("key is missing in KACLS response")),
O(g,5,3),C6().log(Qoi(new B6,g.clone())))}else e(new wpi("Unwrap request to KACLS failed: "+k.rz())),C6().log(Qoi(new B6,g.clone()))},Tb,JSON.stringify(c),Bpi)})}function Dpi(a,b){try{var c=JSON.parse(Zki(a.split(".")[1]))}catch(d){throw new mni(Sji,"Cannot decode authorization token: "+d);}a=c.kacls_url;if(!a)throw new mni(Sji,"Missing KACLS URL in authorization token.");return a.endsWith("/")?a.slice(0,-1)+b:a+b};function Fpi(a){M(this,a,0,-1,null,null)}E(Fpi,L);function Gpi(){var a=new Fpi;return O(a,1,1)}Fpi.prototype.getAuthToken=function(){return N(this,2)};Fpi.prototype.setAuthToken=function(a){return O(this,2,a)};function Hpi(){}
Hpi.prototype.getAuthToken=function(a){var b,c,d,e,f,g,k,l,m,n;return p6(function(q){if(1==q.C)return b={aud:ski,iss:"google-cse-test-authn",email:a.getEmail(),email_verified:!0},c={alg:Fji,typ:"JWT",kid:"test_authn"},d=rCd(JSON.stringify(c),4),b.oY=Math.round(Date.now()/1E3)-1,b.exp=Math.round(b.oY+3600),e=d+"."+rCd(JSON.stringify(b),4),f={alg:Fji,d:"DI4nXowkE3RIcp07CI7NWkOHxe92sFVjgK1XqEikAXH1HK7jBxp9dF5cMKelWsu0GnqSTAMzus04hQ0lBGhGTwVTabMUkGhMRd8QrKWMXbH-DIyDOZtA9ZTg439pIKF-ZOIk2mxEt0P91EmFSq3grIW2xdbDHfnuZEZoPQ6GfMeICwBIIxoNAEbEuPyacVl6WDpfLX3qwtcushPrIo4Jkcbvq2hGk7aj5GX4cr0K1U9Ctlv5G1jSFhzdouSog4GLL2XmxyRDlzSsCxoBTViscitRYV_hHdKDBZWEzOddUoFW_xWTLXm0dlRHFDJMFF